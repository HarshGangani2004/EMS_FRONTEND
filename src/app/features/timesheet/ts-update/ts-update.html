<ng-container *ngIf="!loading">

  <div class="form-container">

    <h2>Update Timesheet</h2>

    <form #form="ngForm" (ngSubmit)="update(form)">

      <!-- PROJECT -->
      <div class="form-group">
        <label>Project <span class="required">*</span></label>

        <select
          class="form-input"
          name="projectId"
          [(ngModel)]="model.projectId"
          #projectId="ngModel"
          required>

          <option value="">Select Project</option>
          <option *ngFor="let p of projects" [value]="p.id">
            {{ p.name }}
          </option>
        </select>

        <span class="error" *ngIf="projectId.invalid && projectId.touched">
          Project is required
        </span>
      </div>

      <!-- WORK TITLE -->
      <div class="form-group">
        <label>Work Title <span class="required">*</span></label>

        <input
          type="text"
          class="form-input"
          name="title"
          [(ngModel)]="model.title"
          minlength="3"
          required
          #title="ngModel" />

        <span class="error" *ngIf="title.touched && title.errors">
          <span *ngIf="title.errors['required']">
            Work title is required
          </span>
          <span *ngIf="title.errors['minlength']">
            Minimum 3 characters required
          </span>
        </span>
      </div>

      <!-- DESCRIPTION -->
      <div class="form-group">
        <label>Description</label>

        <textarea
          class="form-input"
          name="description"
          [(ngModel)]="model.description"
          rows="3">
        </textarea>
      </div>

      <!-- START TIME -->
      <div class="form-group">
        <label>Start Time <span class="required">*</span></label>

        <input
          type="time"
          class="form-input"
          name="startTime"
          [(ngModel)]="model.startTime"
          required
          #startTime="ngModel" />

        <span class="error" *ngIf="startTime.invalid && startTime.touched">
          Start time is required
        </span>
      </div>

      <!-- END TIME -->
      <div class="form-group">
        <label>End Time <span class="required">*</span></label>

        <input
          type="time"
          class="form-input"
          name="endTime"
          [(ngModel)]="model.endTime"
          required
          #endTime="ngModel" />

        <span class="error" *ngIf="endTime.invalid && endTime.touched">
          End time is required
        </span>
      </div>

      <!-- PLANNED HOURS -->
      <div class="form-group">
        <label>Planned Hours <span class="required">*</span></label>

        <input
          type="number"
          step="0.1"
          min="0.1"
          class="form-input"
          name="plannedHours"
          [(ngModel)]="model.plannedHours"
          required
          #plannedHours="ngModel" />

        <span class="error" *ngIf="plannedHours.touched && plannedHours.errors">
          <span *ngIf="plannedHours.errors['required']">
            Planned hours required
          </span>
          <span *ngIf="plannedHours.errors['min']">
            Must be greater than 0
          </span>
        </span>
      </div>

      <!-- STATUS -->
      <div class="form-group">
        <label>Status</label>

        <select
          class="form-input"
          name="status"
          [(ngModel)]="model.status">
          <option value="In Progress">In Progress</option>
          <option value="Completed">Completed</option>
        </select>
      </div>

      <!-- ACTION BUTTONS -->
      <div class="actions">
        <button
          type="submit"
          class="save-btn"
          [disabled]="submitting || form.invalid">

          {{ submitting ? 'Updating...' : 'Update Timesheet' }}
        </button>

        <button
          type="button"
          class="cancel"
          routerLink="/timesheet/my">
          Cancel
        </button>
      </div>

    </form>

  </div>

</ng-container>
